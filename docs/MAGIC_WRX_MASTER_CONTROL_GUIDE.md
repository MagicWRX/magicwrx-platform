# üéØ Magic WRX Master Control Guide

> **Complete deployment, monitoring, and service management protocols for Magic WRX**

## üìã **Table of Contents**

1. [Service Overview](#service-overview)
2. [Environment Management](#environment-management)
3. [Deployment Protocols](#deployment-protocols)
4. [Monitoring & Status](#monitoring--status)
5. [Service Configurations](#service-configurations)
6. [Emergency Procedures](#emergency-procedures)
7. [Quick Reference](#quick-reference)

---

## üåê **Service Overview**

### **Primary Services Stack**
| Service | Purpose | Environment | Status Dashboard |
|---------|---------|-------------|------------------|
| **Vercel** | Frontend Hosting | Production | [vercel.com/dashboard](https://vercel.com/dashboard) |
| **Supabase** | Backend/Auth/DB | Production | [supabase.com/dashboard](https://supabase.com/dashboard) |
| **Stripe** | Payments | Production | [dashboard.stripe.com](https://dashboard.stripe.com) |
| **Resend** | Email Service | Production | [resend.com/dashboard](https://resend.com/dashboard) |
| **GitHub** | Source Control | Repository | [github.com/MagicWRX/MagicWRX](https://github.com/MagicWRX/MagicWRX) |

### **Project URLs**
- **Production**: `https://magic-g7ua1cnfl-magicwrxs-projects.vercel.app`
- **Development**: `http://localhost:3000`
- **Admin Panel**: `/admin`
- **API Endpoints**
## üîê **Environment Management**

### **Environment Files Location**
```
/Users/brianlindahl/Development/Business/Websites/MagicWRX/.env.local
/Users/brianlindahl/Development/Business/Websites/MagicWRX/.env.example
```

### **Critical Environment Variables**

#### **Supabase Configuration**
```bash
NEXT_PUBLIC_SUPABASE_URL="https://ujfcflnrtrkdgfclwelz.supabase.co"
NEXT_PUBLIC_SUPABASE_ANON_KEY="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
```

#### **Email Service (Resend)**
```bash
RESEND_API_KEY="re_CgegqT2Q_K3yY7kJobarR5qDiMgfX24qg"
```

#### **Firebase Configuration (Deprecated)**
```bash
# These variables are deprecated and will be removed
NEXT_PUBLIC_FIREBASE_API_KEY="..."
NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN="..."
```

---

## üöÄ **Deployment Protocols**

### **1. Vercel Deployment (Primary)**

#### **Quick Deploy**
```bash
# From project root
cd /Users/brianlindahl/Development/Business/Websites/MagicWRX
./deploy-vercel.sh
```

#### **Manual Vercel Deploy**
```bash
# Install dependencies
npm install

# Build for production
npm run build

# Deploy to Vercel
vercel --prod

# Or preview deployment
vercel
```

#### **Vercel Configuration Files**
- **Config**: `vercel.json`
- **Setup Guide**: `VERCEL_SETUP.md`
- **Commands**: `VERCEL_COMMANDS.md`

### **2. Firebase Deployment (Static)**

#### **Quick Deploy**
```bash
./deploy.sh
```

#### **Manual Firebase Deploy**
```bash
# Build static export
npm run export

# Deploy to Firebase Hosting
firebase deploy --only hosting
```

#### **Firebase Configuration Files**
- **Config**: `firebase.json`
- **Project**: `.firebaserc`
- **Rules**: `firestore.rules`, `storage.rules`
- **Setup Guide**: `FIREBASE_SETUP.md`

### **3. Git Workflow**

#### **Standard Git Flow**
```bash
# From project root
git add .
git commit -m "feat: your changes"
git push origin master

# Or use helper script
./push-to-github.sh
```

#### **Branch Strategy**
- **Main Branch**: `master`
- **Feature Branches**: `feature/your-feature-name`
- **Hotfix Branches**: `hotfix/issue-description`

---

## üìä **Monitoring & Status**

### **Health Check Scripts**
```bash
# Check all services status
./firebase-status.sh

# Verify environment setup
./verify-setup.sh

# Test integrations
./test-integrations.sh
```

### **Service Status Files**
- **Firebase Status**: Generated by `firebase-status.sh`
- **Test Results**: `test-results.md`
- **Core Functionality**: `test-core-functionality.md`

### **Live Monitoring Dashboards**

#### **Vercel Analytics**
- URL: `https://vercel.com/magicwrxs-projects/magic-wrx/analytics`
- Metrics: Page views, performance, errors

#### **Firebase Console**
- URL: `https://console.firebase.google.com/project/magic-wrx`
- Sections: Authentication, Firestore, Storage, Analytics

#### **Supabase Dashboard**
- URL: `https://supabase.com/dashboard/project/ujfcflnrtrkdgfclwelz`
- Metrics: Database usage, API calls, authentication

---

## ‚öôÔ∏è **Service Configurations**

### **1. Vercel Configuration**

#### **File**: `vercel.json`
```json
{
  "framework": "nextjs",
  "buildCommand": "npm run build",
  "devCommand": "npm run dev",
  "functions": {
    "src/app/api/**/*.ts": {
      "maxDuration": 30
    }
  },
  "regions": ["iad1"]
}
```

#### **Environment Variables Setup**
```bash
# Set Vercel environment variables
vercel env add NEXT_PUBLIC_FIREBASE_API_KEY
vercel env add STRIPE_SECRET_KEY
vercel env add RESEND_API_KEY
# ... (add all required env vars)
```

### **2. Firebase Configuration**

#### **File**: `firebase.json`
- **Hosting**: Static file serving from `out/` directory
- **Firestore**: Database rules and indexes
- **Storage**: File upload rules
- **Emulators**: Local development ports

#### **Project Settings**
- **Project ID**: `magic-wrx`
- **Region**: `us-central1`
- **Authentication**: Email/Password + Google OAuth

### **3. Supabase Configuration**

#### **Project Details**
- **Project URL**: `https://ujfcflnrtrkdgfclwelz.supabase.co`
- **Region**: East US (Virginia)
- **Database**: PostgreSQL

#### **Integration**
```typescript
// lib/supabase.ts
import { createClient } from '@supabase/supabase-js'

const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!
const supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!

export const supabase = createClient(supabaseUrl, supabaseAnonKey)
```

### **4. Stripe Configuration**

#### **Test Mode Settings**
- **Webhooks**: Configure for local development and production
- **Products**: Define subscription tiers
- **Tax Settings**: Configure as needed

#### **Integration Files**
- **Client**: `src/lib/stripe.ts`
- **API Routes**: `src/app/api/stripe/*`
- **Components**: `src/components/PaymentButton.tsx`

### **5. Resend Email Service**

#### **Configuration**
- **API Key**: Stored in environment variables
- **Domain**: Configure custom domain if needed
- **Templates**: Email templates for notifications

---

## üö® **Emergency Procedures**

### **Service Outage Response**

#### **1. Vercel Issues**
```bash
# Check Vercel status
curl -I https://magic-g7ua1cnfl-magicwrxs-projects.vercel.app

# Rollback deployment
vercel rollback

# Alternative: Deploy to Firebase
./deploy.sh
```

#### **2. Firebase Issues**
```bash
# Check Firebase status
./firebase-status.sh

# Switch to emulators for development
./start-emulators.sh

# Alternative: Use Supabase for auth/database
# (Update environment variables)
```

#### **3. Database Issues**
```bash
# Backup Firestore data
firebase firestore:export gs://magic-wrx.appspot.com/backups/$(date +%Y%m%d)

# Switch to Supabase if needed
# Update connection strings in .env.local
```

### **Recovery Scripts**
- **Environment Recovery**: `import-firebase-env.sh`
- **Service Switching**: `firebase-switch.sh`
- **Troubleshooting**: `troubleshoot-github.sh`

---

## üìö **Quick Reference**

### **Essential Commands**
```bash
# Development
npm run dev                    # Start development server
npm run build                  # Build for production
npm run export                 # Static export for Firebase

# Deployment
vercel --prod                  # Deploy to Vercel
firebase deploy                # Deploy to Firebase
./deploy-vercel.sh            # Quick Vercel deploy
./deploy.sh                   # Quick Firebase deploy

# Monitoring
./firebase-status.sh          # Check Firebase services
./verify-setup.sh             # Verify environment
./test-integrations.sh        # Test all integrations
```

### **Important File Paths**

#### **Configuration Files**
- Environment: `.env.local`
- Vercel: `vercel.json`
- Firebase: `firebase.json`, `.firebaserc`
- Next.js: `next.config.js`
- Package: `package.json`

#### **Documentation Files**
- Setup: `SETUP.md`
- Firebase: `FIREBASE_SETUP.md`
- Vercel: `VERCEL_SETUP.md`
- Authentication: `AUTHENTICATION.md`
- Stripe: `STRIPE_INTEGRATION_SETUP.md`

#### **Automation Scripts**
- Development: `start-dev.sh`
- Deployment: `deploy.sh`, `deploy-vercel.sh`
- Testing: `test-script.sh`, `test-integrations.sh`
- Utilities: `firebase-status.sh`, `verify-setup.sh`

### **Admin Access**
- **Admin Emails**: `brian@amazinglystrange.com`, `brian@magicwrx.com`
- **Login URL**: `/admin/login`
- **Dashboard**: `/admin/dashboard`

### **Support Contacts**
- **GitHub Issues**: [MagicWRX/MagicWRX/issues](https://github.com/MagicWRX/MagicWRX/issues)
- **Vercel Support**: [vercel.com/support](https://vercel.com/support)
- **Firebase Support**: [firebase.google.com/support](https://firebase.google.com/support)

---

## üîÑ **Version Control**

### **Current Version**: `v1.1.3`
### **Last Updated**: July 23, 2025
### **Repository**: [github.com/MagicWRX/MagicWRX](https://github.com/MagicWRX/MagicWRX)

---

*This guide should be updated whenever new services are added or configurations change.*
